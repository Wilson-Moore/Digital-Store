{% extends "base.html" %}

{% block content %}
<div class="container">
<div class="card mb-3">
    <div class="row g-0">
      <div class="col-md-4">
        <img src="{{ product.image.url }}" class="img-fluid rounded-start" alt="...">
      </div>
      <div class="col-md-8">
        <div class="card-body">
          <h5 class="card-title">{{ product.name }}</h5>
          <p class="card-text"><br>Price:<br/>{% if product.on_sale %} <strike>${{ product.price }}</strike> ${{ product.sale_price }} {% else %} {{product.price}} {% endif %}</p>
          <p class="card-text"><br>Description:<br/>{{ product.description }}</p>
          <p class="card-text"><br>Category:<br/>{{ product.category.parent }}</p>
          <p class="card-text"><br>Subcategory:<br/>{{ product.category }}</p>
          <button type="button" value="{{ product.id }}" class="btn btn-secondary" id="add-cart">Add to cart</button>
        </div>
      </div>
    </div>
  </div>
</div>

<script>
$(document).on("click","#add-cart",function(e)
{
  e.preventDefault();
  $.ajax({
    type:"POST",
    url:"{% url 'cart_add' %}",
    data:{
      product_id:$("#add-cart").val(),
      csrfmiddlewaretoken:"{{ csrf_token }}",
      action:"post"
    },
    success:function(json)
    {
      document.getElementById("cart-quantity").textContent=json.quantity
    },
    error:function(xhr,errmsg,err){}
  });
})
</script>
{% endblock %}